import { getTableDataContainer } from "../Table/populateTable.min.js";
import { checkDataTable } from "../Table/populateTable.min.js";
import { getID } from "../Table/populateTable.min.js";
import { putTableInfoFromCache } from "../Table/populateTable.min.js";

//When the filter button is clicked it call the filterfunction
var filterbuttone = document.getElementById("filterButton");
    filterbuttone.addEventListener("click", () => {
        filterData();
    });



//when clear button is clicked it take the id of the table that is and put all the info
//withoutbeing filter or smth
var filterbuttone = document.getElementById("clearButton");
filterbuttone.addEventListener("click", () => {
    var id = getID();
    putTableInfoFromCache(id);
});

//it takes all the info that are in the table two dates and send them to filter
//after taking the filter data then it puts in the table only the filtered one
function filterData() {
    var dataBeforeFiltering = getTableDataContainer();
    var first = document.getElementById("date-checkin").value;
    var second = document.getElementById("date-checkout").value;
    var afterFilter = filterDataWithDate(dataBeforeFiltering, first, second);
    var tableFormatData = afterFilter.map(Object.values);
    checkDataTable({ data: tableFormatData }, true);
}

//take all data and two dates and it return all the data that is inide this two dates
function filterDataWithDate(dataToFilter, startDate, endDate) {
    const start = new Date(startDate);
    const end = new Date(endDate);
    const filteredData = dataToFilter.filter((item) => {
        const createdAtDate = new Date(item.createdat);
        return createdAtDate >= start && createdAtDate <= end;
    });
    return filteredData;
}


