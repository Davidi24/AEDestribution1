import { putTableInfoFromCache } from "../Table/populateTable.min.js";

//Put nessesary info to the side bar, client part. We save all data in a variable
// data in case wee need latter
//this function get some data and put them in the table
function displayClients(data) {
    const clientsDiv = document.querySelector(".clientss");
    data.forEach((client) => {
        const vatNumber = client.vatnumber;
        const clientDiv = document.createElement("li");
        clientDiv.textContent = vatNumber;
        clientDiv.id = "clientsVatnumber";
        clientsDiv.appendChild(clientDiv);
        checkIfisCkicked();
    });
}

//This function get the clients from the back-end and in the varible data it send in
// another function(DisplayClients) to display them.
export function getClients() {
    const url = "/getClients";
    fetch(url)
        .then((response) => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json();
        })
        .then((data) => {
            displayClients(data.message);
            return data;
        })
        .catch((error) => {
            console.error("Fetch error:", error);
        });
}

function checkIfisCkicked() {
    var clientsContainer = document.querySelector(".clientss");
    var clientVatElements = clientsContainer.querySelectorAll("#clientsVatnumber");
    clientVatElements.forEach(function (element) {
        element.addEventListener("click", function () {
            putTableInfoFromCache(element.textContent);
        });
    });
}
